<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport"
          content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>IGDB TEST WEB (made by.MH)</title>
    <!-- 제이쿼리 -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65" crossorigin="anonymous">
</head>
<body>
<div class="input-group" style="width : 300px; margin : 50px;">
    <input id="igdb_id" type="search" class="form-control rounded" placeholder="IGDB ID" aria-label="Search" aria-describedby="search-addon" onkeyup="enterkey();"/>
    <button type="button" class="btn btn-outline-primary" onclick="getIgdbItem();">search</button>
</div>

<div style="width : 1000px; margin : 50px;">
    <img id="igdb_image_data" src="/img/default.png" style="width : 265px; height : 363px; float: left; margin-right : 35px;">
    <table class="table" style="text-align: center; width : 700px; float: left;">
        <thead>
        <tr>
            <th scope="col" style="width: 100px;">#</th>
            <th scope="col">DATA</th>
        </tr>
        </thead>
        <tbody>
        <tr>
            <th>Igdb ID</th>
            <td id="igdb_id_data"></td>
        </tr>
        <tr>
            <th>Name</th>
            <td id="igdb_name_data"></td>
        </tr>
        <tr>
            <th>Link</th>
            <td><a id="igdb_link_data"></a></td>
        </tr>
        <tr>
            <th>Summary</th>
            <td><a id="igdb_summary_data"></a></td>
        </tr>
        </tbody>
    </table>
    <div class="spinner-border" role="status" id="roadingStatus" style="display : none;">
        <span class="sr-only"></span>
    </div>
</div>
<script type="text/javascript">
function getIgdbItem() {
    $("#roadingStatus").show();
    var item = $('#igdb_id')[0].value;
	$.ajax({
        type : "POST",
        url : "api/games/"+item,
        dataType : "json"
    }).done(res=> {
        $("#igdb_id_data").text(res.data[0].id);
        $("#igdb_name_data").text(res.data[0].name);
        $("#igdb_link_data").text(res.data[0].url);
        $("#igdb_link_data").attr("href", res.data[0].url);
        $("#igdb_link_data").attr("target", "_blank");
        $("#igdb_summary_data").text(res.data[0].summary);
        $("#igdb_image_data").attr("src", `https://images.igdb.com/igdb/image/upload/t_cover_big/${res.data[1][0].image_id}.jpg`);
        $("#roadingStatus").hide();
    }).fail(error=> {
        console.log("실패",error);
    });
}

function enterkey() {
	if (window.event.keyCode == 13) {
    	getIgdbItem();
    }
}
</script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-kenU1KFdBIe4zVF0s0G1M5b4hcpxyD9F7jL+jjXkk+Q2h455rYXK/7HAuoJl+0I4" crossorigin="anonymous"></script>
</body>
</html>